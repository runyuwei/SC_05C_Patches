# =============================================================================
# Patch Configuration File
# Flexibly modify patches and repositories to be applied
# =============================================================================

# Basic configuration
GERRIT_USER="runyuwei"  # Replace with your actual Gerrit username
GERRIT_HOST="icggerrit.corp.intel.com"
GERRIT_PORT="29418"

# Branch configuration
# Option 1: Auto-generate date-based branch name (recommended)
BRANCH_NAME="patches_$(date +%m%d)"

# Option 2: Use fixed branch name
# BRANCH_NAME="my_feature_branch"

# Option 3: Feature-based naming
# BRANCH_NAME="feature_xxx"

# Option 4: Don't create new branch, apply on current branch (set CREATE_BRANCH to false)
# CREATE_BRANCH=false

# =============================================================================
# Repository and patch configuration
# Format: directory:gerrit_repo_name:patch_id_list(space_separated)
# =============================================================================

# Currently configured patches (you can modify these)
declare -A PATCH_CONFIGS=(
    # Common patches
    ["common"]="hkr-common:850035"

    # IO driver related patches
    ["io"]="soc-io-drivers:850447 851971"
    
    # Application layer patches
    ["apps"]="hkr-apps:850718 852504"
    
    # Device manager patches
    ["framework/device-mgr"]="soc-device-mgr:850719 850896"
    
    # IPU driver patches
    ["components/ipu/drivers"]="ipu-sw-driver:853041 852527"

    # IPU middleware patches
    ["components/ipu/mw"]="ipu-sw-mw:850895"

    # GDF patches
    ["components/ipu/gdf"]="imaging/gdf-official-release:852281"
)

# Processing order (can be adjusted)
REPO_ORDER=("common" "io" "apps" "framework/device-mgr" "components/ipu/drivers" "components/ipu/mw" "components/ipu/gdf")

# =============================================================================
# How to add/modify patches
# =============================================================================

# Add new repository and patches:
# PATCH_CONFIGS["new_directory"]="gerrit_repo_name:patch_id1 patch_id2"
# REPO_ORDER+=("new_directory")

# Modify existing patches (e.g., add new patch to io repository):
# PATCH_CONFIGS["io"]="soc-io-drivers:850447 851971 new_patch_id"

# Remove patches for a repository:
# unset PATCH_CONFIGS["io"]

# Apply only specific patches (comment out unwanted ones):
# PATCH_CONFIGS["io"]="soc-io-drivers:850447"  # Only 850447, remove 851971

# =============================================================================
# Usage examples
# =============================================================================

# 1. Basic usage (apply all configured patches):
#    ./apply_patches_flexible.sh

# 2. Preview mode (see what will be done):
#    ./apply_patches_flexible.sh --dry-run

# 3. Process only specific repository:
#    ./apply_patches_flexible.sh --repo io

# 4. Custom branch name:
#    ./apply_patches_flexible.sh --branch my_test_branch

# 5. Don't create new branch, apply on current branch:
#    ./apply_patches_flexible.sh --no-branch

# 6. Specify username:
#    ./apply_patches_flexible.sh --user your_username
